---
title: Климат в умном доме
date: 2020-10-04
tags:
    - умный дом
    - климат
category: tech
keywords:
    - subtyping
---

## Климат в умном доме

Наступила осень, а вместе с ней и отопительный сезон. Это значит что дома уже не так комфортно присутствовать с выключенным отоплением.

В квартире где я живу установлены радиаторы на которых есть вентили настройки потока горячей воды,также на каждую батарею установлены калориметры который упрощают процесс сбора показателей расхода отопления (поэтому есть смысл экономить).

После сравнения доступных вариантов для автоматизации отопления в квартире я пришел к решению купить термоголовки [eQ3 Bluetooth](https://www.eq-3.com/products/homematic/detail/bluetooth-smart-radiator-thermostat.html).


![eQ3 Smart Radiator thermostat](/images/posts/climate/eq3.png)


Основные преимущества этого решения в том, что они:
- дешевле чем термоголовки оборудованные другим интерфейсом удаленного управления
- не требуют хаба для централизованного управления

При этом они незначительно дороже, чем обычные термоголовки с программируемым термостатом.

Приложение производителя реализовано приемлемо и в нём удобный интерфейс настройки расписание.

Расписание задается на неделю. Можно для каждого дня недели задавать неограниченное количество установок температуры, а также копировать дни недели чтобы не повторять эту процедуру несколько раз для выходных или будних дней.

У термоголовок есть дополнительные возможности в виде режима Boost, а также детектор открытого окна.

Основным недостатком этих термоголовок является то что они измеряют температуру прямо около батареи.

### Идеальные сценарии интеграции в умный дом
Далее я хочу описать идеальный вариант управления отоплением в умном доме.

В Home Assistant уже существует компонента для использования термоголовок, а значит уже сейчас без дополнительной настройки можно указать температуру прямо из интерфейса Home Assistant. Для настройки нужно только узнать Bluetooth Mac адрес устройства.

![Lovelace Thermostate card](/images/posts/climate/thermostat.png)

Также я отказался от идеи изменения по расписанию с приложения, потому что удобнее настраивать настройки температура в одном месте.

На данный момент меня есть конфигурация для двух комнат.
Я использую компоненту [Scheduler](https://github.com/nielsfaber/scheduler-component), а для отображения её в интерфейсе [Lovelace scheduler card](https://github.com/nielsfaber/scheduler-card).

![Scheduler Home Assistant](/images/posts/climate/scheduler.png)

### Сценарии

При работе из дома необходимо, чтобы отопление в зале была включено
заранее, перед моментом пробуждения и до момента в середине дня когда отопление уже не нужно и квартира останется тёплой до вечера.

Отопление в спальне в целом не нужно (спать в холоде комфортнее), за исключением ситуаций когда нужно прогреть комнату вручную для того чтобы, например, позаниматься в ней спортом.

Необходимо всегда выключать батарею в спальне после ручной настройки чтобы случайно не забыть выключить её и не потратить много энергии.

Нужно полностью выключать отопление даже в зале, когда все жители квартиры покидают дом. При этом в идеале прогревать квартиру к приходу домой (учитывая приближение к дому).

В зале точка для которой нужно прогревать квартиру должна отличаться в зависимости от времени суток. Это значит что нужно создать идеальную температуру в рабочее часы около рабочего места, а в вечерних около дивана и зоны кухни.

Все это также будет требовать хорошо настроенной компоненты присутствие дома.

Я также постараюсь настроить интеграцию с моим будильником, чтобы от него зависело то в какой момент умный дом начинает прогревать квартиру утром.

Использование generic компоненты термостата позволит использовать другой термодатчик как целевой для включения отопления. Батарея будет использоваться как выключатель в двух состояниях включено или выключено.

Не думаю что использование максимальной температуры и полного выключения на батарее целесообразно потому что в таком случае батарея еще длительное время будет горячий и будет перегревать помещение.

В идеале нужно реализовать что-то вроде PID терморегуляции которая бы постепенно повышалась температура в батарее и максимально эффективно точно прогревать комнату.

Также нужно использовать независимые датчики открытия окон чтобы автоматически выключать батареи при открытии окна и проветривании. Проблема особенно актуальна в спальне. Это поведение должно быть совместимым с расписанием температуры.

## Итог

Сейчас всего этого ещё пока не реализовано. Я постараюсь в следующих частях описать шаги для реализации всех сценариев описанных в этой заметке.

